(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-892d7612"],{"552c":function(e,t,a){"use strict";a("60bb")},"60bb":function(e,t,a){},"7aa2":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("加工过程管理")]),a("el-breadcrumb-item",[e._v("加工过程")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticClass:"input-with-select",attrs:{clearable:"",placeholder:"请输入内容"},on:{clear:e.getproductList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.queryMsg},slot:"append"})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.clickAdd()}}},[e._v("添加加工信息")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.productList}},[a("el-table-column",{attrs:{label:"编号",type:"index"}}),a("el-table-column",{attrs:{prop:"qymc",label:"生产企业名称",width:"180"}}),a("el-table-column",{attrs:{prop:"cpmc",label:"产品名称",width:"140"}}),a("el-table-column",{attrs:{prop:"pch",label:"加工批次号",width:"140"}}),a("el-table-column",{attrs:{prop:"picture",label:"加工图片",width:"140"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.picture,alt:"暂无图片",width:"100px",height:"100px"}})]}}])}),a("el-table-column",{attrs:{prop:"process_name",label:"加工过程",width:"180"}}),a("el-table-column",{attrs:{prop:"process_way",label:"加工方式",width:"120"}}),a("el-table-column",{attrs:{prop:"process_time",label:"加工时间",width:"120"}}),a("el-table-column",{attrs:{prop:"fzr",label:"操作人",width:"180"}}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"top-start"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.showEditDialog(t.row.id)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top-end"}},[a("el-button",{attrs:{type:"warning",icon:"el-icon-delete"},on:{click:function(a){return e.removeById(t.row.id)}}})],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.queryInfo.current_page,background:"",layout:"prev, pager, next, total",total:e.total,"page-size":e.queryInfo.pageSize},on:{"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"添加加工过程信息",visible:e.addDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addFormClosed}},[a("el-form",{ref:"addJggcInfo",attrs:{rules:e.FormRules,enctype:"multipart/form-data",model:e.addJggcInfo,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"产品名称",prop:"cpmc"}},[a("el-select",{staticClass:"select-width",attrs:{placeholder:"请选择产品名称"},on:{change:e.getAddPch},model:{value:e.addJggcInfo.cpmc,callback:function(t){e.$set(e.addJggcInfo,"cpmc",t)},expression:"addJggcInfo.cpmc"}},e._l(e.cpmcList,(function(e){return a("el-option",{key:e.index,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"加工批次",prop:"pch"}},[a("el-select",{staticClass:"select-width",attrs:{placeholder:"请选择产品批次号"},model:{value:e.addJggcInfo.pch,callback:function(t){e.$set(e.addJggcInfo,"pch",t)},expression:"addJggcInfo.pch"}},e._l(e.pchList,(function(e){return a("el-option",{key:e.index,attrs:{value:e,label:e}})})),1)],1),a("el-form-item",{attrs:{label:"加工过程",prop:"process_name"}},[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入加工过程"},on:{select:e.handleSelect},model:{value:e.addJggcInfo.process_name,callback:function(t){e.$set(e.addJggcInfo,"process_name",t)},expression:"addJggcInfo.process_name"}})],1),a("el-form-item",{attrs:{label:"图片名称",prop:"process_pic"}},[a("el-input",{attrs:{disabled:""},model:{value:e.addJggcInfo.process_pic,callback:function(t){e.$set(e.addJggcInfo,"process_pic",t)},expression:"addJggcInfo.process_pic"}})],1),a("el-form-item",{attrs:{label:"加工过程图片上传"}},[a("el-upload",{ref:"addUpload",staticClass:"upload-demo",attrs:{name:"image",action:e.uploadURL,"on-success":e.successEvent,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png格式的图片，且图片大小不能超过1MB")])],1)],1),a("el-form-item",{attrs:{label:"加工方式",prop:"process_way"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addJggcInfo.process_way,callback:function(t){e.$set(e.addJggcInfo,"process_way",t)},expression:"addJggcInfo.process_way"}},e._l(e.jgfsOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"作业日期",prop:"process_time"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.addJggcInfo.process_time,callback:function(t){e.$set(e.addJggcInfo,"process_time",t)},expression:"addJggcInfo.process_time"}})],1),a("el-form-item",{attrs:{label:"负责人",prop:"fzr"}},[a("el-input",{model:{value:e.addJggcInfo.fzr,callback:function(t){e.$set(e.addJggcInfo,"fzr",t)},expression:"addJggcInfo.fzr"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑加工过程信息",visible:e.editDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.addFormClosed}},[a("el-form",{ref:"editFormRef",attrs:{rules:e.FormRules,enctype:"multipart/form-data",model:e.editJggcInfo,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"产品名称"}},[a("el-select",{staticClass:"select-width",attrs:{placeholder:"请选择产品名称"},on:{change:e.getPch},model:{value:e.editCpmc,callback:function(t){e.editCpmc=t},expression:"editCpmc"}},e._l(e.cpmcList,(function(e){return a("el-option",{key:e.index,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"加工批次"}},[a("el-select",{staticClass:"select-width",attrs:{placeholder:"请选择产品批次号"},model:{value:e.editJggcInfo.pch,callback:function(t){e.$set(e.editJggcInfo,"pch",t)},expression:"editJggcInfo.pch"}},e._l(e.pchList,(function(e){return a("el-option",{key:e.index,attrs:{value:e,label:e}})})),1)],1),a("el-form-item",{attrs:{label:"加工过程",prop:"cpmc"}},[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入加工过程"},on:{select:e.handleSelect},model:{value:e.editJggcInfo.process_name,callback:function(t){e.$set(e.editJggcInfo,"process_name",t)},expression:"editJggcInfo.process_name"}})],1),a("el-form-item",{attrs:{label:"图片名称",prop:"picname"}},[a("el-input",{attrs:{disabled:""},model:{value:e.editJggcInfo.process_pic,callback:function(t){e.$set(e.editJggcInfo,"process_pic",t)},expression:"editJggcInfo.process_pic"}})],1),a("el-form-item",{attrs:{label:"加工过程图片上传"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"image",action:e.uploadURL,"on-success":e.successEvent,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png格式的图片，且图片大小不能超过1MB")])],1)],1),a("el-form-item",{attrs:{label:"加工方式",prop:"cpgg"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editJggcInfo.process_way,callback:function(t){e.$set(e.editJggcInfo,"process_way",t)},expression:"editJggcInfo.process_way"}},e._l(e.jgfsOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"作业日期",prop:"rq"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.editJggcInfo.process_time,callback:function(t){e.$set(e.editJggcInfo,"process_time",t)},expression:"editJggcInfo.process_time"}})],1),a("el-form-item",{attrs:{label:"负责人",prop:"bzq"}},[a("el-input",{model:{value:e.editJggcInfo.fzr,callback:function(t){e.$set(e.editJggcInfo,"fzr",t)},expression:"editJggcInfo.fzr"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.editSubmit}},[e._v("确 定")])],1)],1)],1)},s=[],r=a("1da1"),c=(a("4de4"),a("d3b7"),a("96cf"),{data:function(){return{queryInfo:{query:"",pageSize:5,current_page:1,page:1},total:0,productList:[],addDialogVisible:!1,addJggcInfo:{cpmc:"",pch:"",process_name:"",process_way:"",fzr:"",process_time:"",process_pic:""},jgfsOptions:[{value:"手动",label:"手动"},{value:"机械",label:"机械"}],cpInfoList:[],cpmcList:[],pchList:[],printCpmc:"",processName:[{value:"杀青",address:"长宁区新渔路144号"},{value:"揉捻",address:"上海市长宁区淞虹路661号"},{value:"干燥",address:"上海市普陀区真北路988号创邑金沙谷6号楼113"},{value:"制型",address:"天山西路438号"}],value:"",editJggcInfo:{id:"",pch:"",process_name:"",process_way:"",fzr:"",process_time:"",process_pic:""},editCpmc:"",editProductForm:{},editProductFormPicname:"",editDialogVisible:!1,tokenStr:window.sessionStorage.getItem("token"),uploadURL:"",headerObj:{token:window.sessionStorage.getItem("token")},FormRules:{editCpmc:[{required:!0,message:"请输入产品名称",trigger:"blur"}]}}},created:function(){this.getproductList(),this.setUploadURL()},methods:{getproductList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window.sessionStorage.getItem("token"),t.next=3,e.$http.post("ProcessList",{page:e.queryInfo.current_page,query:e.queryInfo.query});case 3:if(a=t.sent,o=a.data,0===o.code){t.next=7;break}return t.abrupt("return",e.$message.error("获取产品列表数据失败！"));case 7:e.productList=o.data.result,e.total=o.data.total,console.log(o);case 10:case"end":return t.stop()}}),t)})))()},handleCurrentChange:function(e){this.queryInfo.current_page=e,this.getproductList()},queryMsg:function(){this.getproductList()},clickAdd:function(){console.log(123),this.addDialogVisible=!0,this.getPrintData()},getPrintData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("ProductionInfo",e.queryInfo);case 2:for(a=t.sent,o=a.data,console.log(o),e.cpInfoList=o.data.result,s=0;s<e.cpInfoList.length;s++)-1==e.cpmcList.indexOf(e.cpInfoList[s].cpmc)&&e.cpmcList.push(e.cpInfoList[s].cpmc);console.log(e.cpInfoList);case 8:case"end":return t.stop()}}),t)})))()},getPch:function(){this.pchList=[];for(var e=0;e<this.cpInfoList.length;e++)this.editCpmc==this.cpInfoList[e].cpmc&&this.pchList.push(this.cpInfoList[e].pch)},getAddPch:function(){this.pchList=[];for(var e=0;e<this.cpInfoList.length;e++)this.addJggcInfo.cpmc==this.cpInfoList[e].cpmc&&this.pchList.push(this.cpInfoList[e].pch)},addFormClosed:function(){console.log(this.$refs),this.$refs.addFormRef.resetFields(),this.$refs.upload.clearFiles()},showEditDialog:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),a.next=3,t.$http.post("EditProcessInfo",{id:e});case 3:o=a.sent,s=o.data,console.log(s.data),t.editJggcInfo.id=e,t.editJggcInfo.pch=s.data.pch,t.editJggcInfo.process_name=s.data.process_name,t.editJggcInfo.process_way=s.data.process_way,t.editJggcInfo.process_time=s.data.process_time,t.editJggcInfo.fzr=s.data.fzr,t.editDialogVisible=!0,t.getPrintData();case 14:case"end":return a.stop()}}),a)})))()},editSubmit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.editDialogVisible=!1,t.next=3,e.$http.post("DoEditProcessInfo",e.editJggcInfo);case 3:a=t.sent,o=a.data,e.getproductList(),1==o.code?(e.$message.success("产品信息编辑成功"),e.getproductList()):e.$message.error("产品信息编辑失败");case 7:case"end":return t.stop()}}),t)})))()},removeById:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("此操作将永久删除该条信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(o=a.sent,"confirm"==o){a.next=5;break}return a.abrupt("return",t.$message.info("取消了删除操作"));case 5:return a.next=7,t.$http.post("DelProcessInfo",{id:e});case 7:s=a.sent,r=s.data,0==r.code?(t.$message.success("删除成功"),t.getproductList()):t.$message.error("删除失败");case 10:case"end":return a.stop()}}),a)})))()},addSubmit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("AddProcessInfo",e.addJggcInfo);case 2:if(a=t.sent,o=a.data,console.log(o),0===o.code){t.next=7;break}return t.abrupt("return",e.$message.error("添加产品失败"));case 7:e.$refs.addJggcInfo.resetFields(),e.$refs.addUpload.clearFiles(),e.addDialogVisible=!1,e.$message.success("产品添加成功"),e.getproductList();case 12:case"end":return t.stop()}}),t)})))()},handlePreview:function(){},handleRemove:function(){},successEvent:function(e,t,a){this.addJggcInfo.process_pic=e.data.saveName,this.editJggcInfo.process_pic=e.data.saveName},setUploadURL:function(){this.tokenStr=window.sessionStorage.getItem("token"),this.uploadURL="http://ahteaapi.wtycms.cn/Processupload?token="+this.tokenStr,console.log(this.uploadURL)},querySearch:function(e,t){var a=this.processName,o=e?a.filter(this.createFilter(e)):a;t(o)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelect:function(e){console.log(e)}}}),n=c,i=(a("552c"),a("2877")),l=Object(i["a"])(n,o,s,!1,null,"c808dd06",null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-892d7612.639cbeb3.js.map