{"version":3,"sources":["webpack:///./src/components/enterprise/cunzheng/proDuctCunzheng.vue?0a63","webpack:///./src/components/enterprise/cunzheng/proDuctCunzheng.vue?4d3d","webpack:///src/components/enterprise/cunzheng/proDuctCunzheng.vue","webpack:///./src/components/enterprise/cunzheng/proDuctCunzheng.vue?498b","webpack:///./src/components/enterprise/cunzheng/proDuctCunzheng.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","path","_v","staticClass","on","getproductList","model","value","queryInfo","callback","$$v","$set","expression","queryMsg","slot","addProductZS","staticStyle","productList","scopedSlots","_u","key","fn","scope","row","pic_name","status","_s","hash_code","$event","removeById","id","flag","_e","upChain","current_page","total","pageSize","handleCurrentChange","addDialogVisible","addFormClosed","addFormInfo","_l","item","bh","cpmc","label","uploadURL","successEvent","submitspyb","staticRenderFns","data","query","editProductForm","editProductFormPicname","editDialogVisible","tokenStr","headerObj","token","FormRules","created","methods","newPage","console","log","$refs","addFormRef","resetFields","upload","clearFiles","handlePreview","handleRemove","component"],"mappings":"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","file":"js/chunk-2271a1ea.3208d8ed.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./proDuctCunzheng.vue?vue&type=style&index=0&id=fe220a4a&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"区块链存证系统\")]),_c('el-breadcrumb-item',[_vm._v(\"产品存证系统\")])],1),_c('el-card',{staticClass:\"box-card\"},[_c('el-row',{attrs:{\"gutter\":10}},[_c('el-col',{attrs:{\"span\":6}},[_c('el-input',{staticClass:\"input-with-select\",attrs:{\"clearable\":\"\",\"placeholder\":\"请输入内容\"},on:{\"clear\":_vm.getproductList},model:{value:(_vm.queryInfo.query),callback:function ($$v) {_vm.$set(_vm.queryInfo, \"query\", $$v)},expression:\"queryInfo.query\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.queryMsg},slot:\"append\"})],1)],1),_c('el-col',{attrs:{\"span\":2}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addProductZS}},[_vm._v(\"添加产品证书\")])],1)],1),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.productList}},[_c('el-table-column',{attrs:{\"label\":\"编号\",\"type\":\"index\"}}),_c('el-table-column',{attrs:{\"prop\":\"qymc\",\"label\":\"生产企业名称\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"cpmc\",\"label\":\"产品名称\",\"width\":\"140\"}}),_c('el-table-column',{attrs:{\"prop\":\"youji_name\",\"label\":\"证书图片\",\"width\":\"140\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('img',{attrs:{\"src\":scope.row.pic_name,\"alt\":\"暂无图片\",\"width\":\"100px\",\"height\":\"100px\"}})]}}])}),_c('el-table-column',{attrs:{\"prop\":\"flag\",\"label\":\"证书类型\",\"width\":\"80\"}}),_c('el-table-column',{attrs:{\"prop\":\"end_time\",\"label\":\"证书到期时间\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"label\":\"是否上链\",\"width\":\"80\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"type\":scope.row.status === '0' ? 'primary' : 'success',\"disable-transitions\":\"\"}},[_vm._v(_vm._s(scope.row.status === '0' ? '未上链' : '已上链')+\" \")])]}}])}),_c('el-table-column',{attrs:{\"prop\":\"hash_code\",\"label\":\"上链凭证\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"name-wrapper\",attrs:{\"slot\":\"reference\"},slot:\"reference\"},[_c('el-tag',{attrs:{\"size\":\"medium\"}},[_vm._v(_vm._s(scope.row.status === '0' ? '等待上链，暂无凭证' : scope.row.hash_code))])],1)]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"270\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [((scope.row.status == 0)? true :false)?_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"删除\",\"placement\":\"top-end\"}},[_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\"},on:{\"click\":function($event){return _vm.removeById(scope.row.id,scope.row.flag)}}})],1):_vm._e(),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"信息上链\",\"placement\":\"top-end\"}},[_c('el-button',{attrs:{\"type\":\"success\",\"icon\":\"el-icon-link\"},on:{\"click\":function($event){return _vm.upChain(scope.row.id,scope.row.flag)}}})],1)]}}])})],1),_c('el-pagination',{attrs:{\"current-page\":_vm.queryInfo.current_page,\"background\":\"\",\"layout\":\"prev, pager, next, total\",\"total\":_vm.total,\"page-size\":_vm.queryInfo.pageSize},on:{\"current-change\":_vm.handleCurrentChange}})],1),_c('el-dialog',{attrs:{\"title\":\"添加产品证书信息\",\"visible\":_vm.addDialogVisible,\"width\":\"40%\"},on:{\"update:visible\":function($event){_vm.addDialogVisible=$event},\"close\":_vm.addFormClosed}},[_c('el-form',{attrs:{\"label-position\":\"left\",\"label-width\":\"140px\",\"model\":_vm.addFormInfo}},[_c('el-form-item',{attrs:{\"label\":\"产品名称\",\"prop\":\"cpbh\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择产品\"},model:{value:(_vm.addFormInfo.cpbh),callback:function ($$v) {_vm.$set(_vm.addFormInfo, \"cpbh\", $$v)},expression:\"addFormInfo.cpbh\"}},_vm._l((_vm.selectProduct),function(item){return _c('el-option',{key:item.bh,attrs:{\"label\":item.cpmc,\"value\":item.bh}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"产品认证类型\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择上传的存证类型\"},model:{value:(_vm.addFormInfo.flag),callback:function ($$v) {_vm.$set(_vm.addFormInfo, \"flag\", $$v)},expression:\"addFormInfo.flag\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"三品一标证书上传\"}},[_c('el-upload',{attrs:{\"name\":\"image\",\"action\":_vm.uploadURL,\"list-type\":\"picture-card\",\"on-success\":_vm.successEvent}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),_c('el-form-item',{attrs:{\"label\":\"颁证日期\",\"prop\":\"start_time\"}},[_c('el-date-picker',{attrs:{\"value-format\":\"yyyy-MM-dd\",\"format\":\"yyyy-MM-dd\",\"type\":\"date\",\"placeholder\":\"选择日期\"},model:{value:(_vm.addFormInfo.start_time),callback:function ($$v) {_vm.$set(_vm.addFormInfo, \"start_time\", $$v)},expression:\"addFormInfo.start_time\"}})],1),_c('el-form-item',{attrs:{\"label\":\"证书失效日期\",\"prop\":\"end_time\"}},[_c('el-date-picker',{attrs:{\"value-format\":\"yyyy-MM-dd\",\"format\":\"yyyy-MM-dd\",\"type\":\"date\",\"placeholder\":\"选择日期\"},model:{value:(_vm.addFormInfo.end_time),callback:function ($$v) {_vm.$set(_vm.addFormInfo, \"end_time\", $$v)},expression:\"addFormInfo.end_time\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.addDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submitspyb}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <!-- 面包屑导航 -->\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>区块链存证系统</el-breadcrumb-item>\r\n      <el-breadcrumb-item>产品存证系统</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 卡片视图区 -->\r\n    <el-card class=\"box-card\">\r\n      <!-- 搜索与添加区域 -->\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"6\">\r\n          <el-input @clear=\"getproductList\"  clearable placeholder=\"请输入内容\" class=\"input-with-select\" v-model=\"queryInfo.query\">\r\n            <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"queryMsg\"></el-button>\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :span=\"2\">\r\n          <el-button type=\"primary\" @click=\"addProductZS\">添加产品证书</el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <!-- 产品列表区域 -->\r\n      <el-table\r\n       :data=\"productList\" style=\"width: 100%\">\r\n        <el-table-column label=\"编号\" type=\"index\"></el-table-column>\r\n        <el-table-column prop=\"qymc\" label=\"生产企业名称\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"cpmc\" label=\"产品名称\" width=\"140\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"youji_name\" label=\"证书图片\" width=\"140\">\r\n          <template slot-scope=\"scope\">\r\n            <img :src=\"scope.row.pic_name\" alt=\"暂无图片\" width=\"100px\" height=\"100px\" />\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"flag\" label=\"证书类型\" width=\"80\"> </el-table-column>\r\n        <el-table-column prop=\"end_time\" label=\"证书到期时间\" width=\"180\"> </el-table-column>\r\n         <el-table-column\r\n      label=\"是否上链\"\r\n      width=\"80\"\r\n      >\r\n      <template slot-scope=\"scope\">\r\n            <el-tag\r\n          :type=\"scope.row.status === '0' ? 'primary' : 'success'\"\r\n          disable-transitions>{{scope.row.status === '0' ? '未上链' : '已上链'}}\r\n          </el-tag>\r\n      </template>\r\n    </el-table-column>\r\n        <el-table-column prop=\"hash_code\" label=\"上链凭证\" > \r\n              <template slot-scope=\"scope\">\r\n          <div slot=\"reference\" class=\"name-wrapper\">\r\n            <el-tag size=\"medium\">{{ scope.row.status === '0' ? '等待上链，暂无凭证' : scope.row.hash_code}}</el-tag>\r\n          </div>\r\n      </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"270\">\r\n          <!-- 插槽自定义样式 -->\r\n          <template slot-scope=\"scope\">\r\n            <!-- <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"编辑\"\r\n              placement=\"top-start\"\r\n              \r\n            >\r\n              <el-button type=\"primary\" @click=\"showEditDialog(scope.row.bh)\" icon=\"el-icon-edit\"></el-button>\r\n            </el-tooltip> -->\r\n            <el-tooltip\r\n              v-if= \"(scope.row.status == 0)? true :false\"\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"删除\"\r\n              placement=\"top-end\"\r\n            >\r\n              <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"removeById(scope.row.id,scope.row.flag)\"></el-button>\r\n            </el-tooltip>\r\n             <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"信息上链\"\r\n              placement=\"top-end\"\r\n            >\r\n              <el-button type=\"success\" icon=\"el-icon-link\" @click=\"upChain(scope.row.id,scope.row.flag)\"></el-button>\r\n            </el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页区域 -->\r\n      <el-pagination\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"queryInfo.current_page\"\r\n        background\r\n        layout=\"prev, pager, next, total\"\r\n        :total=\"total\"\r\n        :page-size=\"queryInfo.pageSize\"\r\n      >\r\n      </el-pagination>\r\n    </el-card>\r\n    <!-- 新增产品dialog弹窗开始 -->\r\n    <el-dialog\r\n  title=\"添加产品证书信息\"\r\n  :visible.sync=\"addDialogVisible\"\r\n  width=\"40%\"\r\n  @close=\"addFormClosed\"\r\n >\r\n  \r\n<el-form label-position=\"left\" label-width=\"140px\" :model=\"addFormInfo\">\r\n     <el-form-item label=\"产品名称\"  prop=\"cpbh\">\r\n            <el-select v-model=\"addFormInfo.cpbh\" placeholder=\"请选择产品\">\r\n              <el-option :label=\"item.cpmc\" v-for=\"item in selectProduct\" :key=\"item.bh\" :value=\"item.bh\"></el-option>\r\n            </el-select>\r\n      </el-form-item>\r\n  <el-form-item label=\"产品认证类型\">\r\n     <el-select v-model=\"addFormInfo.flag\" placeholder=\"请选择上传的存证类型\">\r\n    <el-option\r\n      v-for=\"item in options\"\r\n      :key=\"item.value\"\r\n      :label=\"item.label\"\r\n      :value=\"item.value\">\r\n    </el-option>\r\n  </el-select>\r\n  </el-form-item>\r\n\r\n  <el-form-item label=\"三品一标证书上传\">\r\n      <el-upload\r\n  name=\"image\"\r\n  :action=\"uploadURL\"\r\n  list-type=\"picture-card\"\r\n  :on-success=\"successEvent\">\r\n  <i class=\"el-icon-plus\"></i>\r\n</el-upload>\r\n  </el-form-item>\r\n  <el-form-item label=\"颁证日期\"  prop=\"start_time\">\r\n            <el-date-picker\r\n              value-format=\"yyyy-MM-dd\"\r\n              format=\"yyyy-MM-dd\"\r\n              v-model=\"addFormInfo.start_time\"\r\n              type=\"date\"\r\n              placeholder=\"选择日期\"\r\n            >\r\n            </el-date-picker>\r\n          </el-form-item>\r\n    <el-form-item label=\"证书失效日期\"  prop=\"end_time\">\r\n            <el-date-picker\r\n              value-format=\"yyyy-MM-dd\"\r\n              format=\"yyyy-MM-dd\"\r\n              v-model=\"addFormInfo.end_time\"\r\n              type=\"date\"\r\n              placeholder=\"选择日期\"\r\n            >\r\n            </el-date-picker>\r\n   </el-form-item>        \r\n \r\n</el-form>\r\n\r\n  <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"addDialogVisible = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"submitspyb\">确 定</el-button>\r\n  </span>\r\n</el-dialog>\r\n <!-- 产品dialog弹窗结束 -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 获取产品列表的参数对象\r\n      queryInfo: {\r\n        query: \"\",\r\n        // 每页显示多少条\r\n        pageSize:5,\r\n        // 当所处页数\r\n        current_page: 1\r\n      },\r\n      total:0,\r\n      productList:[],\r\n      addDialogVisible:false,\r\n      // dialog新增产品表单数据对象\r\n      addFormInfo:{\r\n          cpbh:'',\r\n          flag:'',\r\n          pic_name:'',\r\n          end_time:'',\r\n          start_time:''\r\n      },\r\n      editProductForm:{},\r\n      editProductFormPicname:'',\r\n      editDialogVisible:false,\r\n      tokenStr:window.sessionStorage.getItem('token'),\r\n      uploadURL:'',\r\n      headerObj:{\r\n        token:window.sessionStorage.getItem('token')\r\n      },\r\n      // 表单验证规则\r\n      FormRules:{\r\n        cpmc:[\r\n          { required: true, message: '请输入产品名称', trigger: 'blur' }\r\n        ],\r\n        // bzq:[\r\n        //   { required: true, message: '请输入产品保质期,单位天', trigger: 'blur' },\r\n        //   {type:'number',message: '请填写数字', trigger: 'blur'}\r\n        // ]\r\n      },\r\n       spybDialogVisible:false,\r\n          options: [{\r\n          value: '1',\r\n          label: '有机证书'\r\n        }, {\r\n          value: '2',\r\n          label: '绿色证书'\r\n        }, {\r\n          value: '3',\r\n          label: '地理标识证书'\r\n        }],\r\n        uploadForm:{\r\n          flag:'',\r\n          license_name:''\r\n        },\r\n        selectProduct:[]\r\n    };\r\n  },\r\n  created() {\r\n    this.getproductList();\r\n  },\r\n  methods: {\r\n    async getproductList() {\r\n      const{data:res} =await this.$http.post('LicenseList');\r\n      // if (res.code !== 0) return this.$message.error(\"获取产品列表数据失败！\");\r\n      this.productList = res.data;\r\n      console.log(res)\r\n  \r\n    },\r\n    // 分页功能--监听当前页码值 改变事件\r\n    handleCurrentChange(newPage) {\r\n      // console.log(\"当前页是\" + newPage);\r\n      this.queryInfo.current_page = newPage\r\n      this.getproductList();\r\n    },\r\n    // 查询按钮事件\r\n    queryMsg(){\r\n        this.getproductList();\r\n    },\r\n    // 关闭dialog弹窗的回调函数\r\n    addFormClosed(){\r\n      // 在关闭dialog时重置表单\r\n      console.log(this.$refs)\r\n      this.$refs.addFormRef.resetFields();\r\n      this.$refs.upload.clearFiles();\r\n    },\r\n    async addProductZS(){\r\n        this.tokenStr = window.sessionStorage.getItem('token');\r\n         this.uploadURL = 'http://ahteaapi.wtycms.cn/Spybupload?token=' + this.tokenStr;\r\n        // console.log(this.uploadURL)\r\n        //  产品名称，下拉框数据\r\n    const {data: selectProductRes} =await this.$http.post('SelectProduction',{token:this.tokenStr})\r\n    this.selectProduct =  selectProductRes.data;\r\n    console.log(selectProductRes.data)\r\n    this.addDialogVisible = true;\r\n    },\r\n    submitspyb(){\r\n        this.$http.post('AddLicenseInfo',this.addFormInfo)\r\n        this.addDialogVisible= false;\r\n    },\r\n     // 图片上传成功，获取图片名称，存入提交表单中\r\n     successEvent(response, file, fileList){\r\n        this.addFormInfo.license_name = response.data.saveName;\r\n        // this.editProductForm.picname = file.name;\r\n        console.log(response,file.name)\r\n    },\r\n    // 编辑按钮点击事件\r\n    async showEditDialog(id){\r\n      console.log(id)\r\n     const {data:res} = await this.$http.post('EditProductInfo',{\r\n        token:this.tokenStr,\r\n        bh:id\r\n      })\r\n      console.log(res.data);\r\n      this.editProductForm = res.data;\r\n      this.editDialogVisible = true;\r\n    },\r\n    // 提交编辑弹框修改\r\n    async editProductSubmit(){\r\n      this.editDialogVisible = false;\r\n       const{data:res} = await this.$http.post('DoEditProductInfo',{\r\n        token:this.tokenStr,\r\n        bh:this.editProductForm.bh,\r\n        picname:this.editProductForm.picname,\r\n        qymc:this.editProductForm.qymc,\r\n        cpmc:this.editProductForm.cpmc,\r\n        cpgg:this.editProductForm.cpgg,\r\n        bzq:this.editProductForm.bzq,\r\n        ms:this.editProductForm.ms\r\n      })\r\n      this.getproductList();\r\n      if(res.code == 1){\r\n         this.$message.success('产品信息编辑成功')\r\n      this.getproductList();\r\n    }else{ \r\n      this.$message.error('产品信息编辑失败')\r\n    }\r\n     \r\n     \r\n      // console.log(res)\r\n    },\r\n    // 通过id删除产品信息\r\n      async removeById(id,flag){\r\n      // console.log(id)\r\n      const res = await this.$confirm('此操作将删除该条证书, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).catch(\r\n          err=>err\r\n        );\r\n      if(res != 'confirm'){\r\n        return this.$message.info('取消了删除操作')\r\n      }\r\n      // console.log(tokenStr)\r\n     const {data:removeRes} =await this.$http.post('DelLicenseInfo',{id:id,flag:flag});\r\n      console.log(removeRes);\r\n      if(removeRes.code == 0){\r\n        this.$message.success('删除成功')\r\n        this.getproductList();\r\n      }else{\r\n        this.$message.error('删除失败')\r\n      }\r\n      \r\n    },\r\n    // 新增产品提交事件\r\n   async addProductSubmit(){\r\n        this.addProductForm.token = this.tokenStr;\r\n       const {data:res} =await this.$http.post('AddProductInfo',this.addProductForm)\r\n        console.log(res)\r\n        if(res.code !==0){return this.$message.error('添加产品失败')}\r\n        this.addDialogVisible=false;\r\n        this.$message.success('产品添加成功')\r\n        this.getproductList();\r\n    },\r\n    // 产品添加图片预览\r\n    handlePreview(){\r\n\r\n    },\r\n    // 产品添加移除图片\r\n    handleRemove(){\r\n\r\n    },\r\n    // 点击上链按钮，实现数据上链\r\n     upChain(id,flag){\r\n         this.$confirm('此操作将信息上链，上链后数据无法更改, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          this.$http.post('Setstatus',{id:id,flag:flag})\r\n          this.$message({\r\n            type: 'success',\r\n            message: '信息上链成功!'\r\n          });\r\n        }).catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          });          \r\n        });\r\n      // console.log(id,flag)\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.el-breadcrumb {\r\n  height: 30px;\r\n}\r\n.el-pagination {\r\n  margin-top: 10px;\r\n}\r\n.el-upload-dragger{\r\n  margin-left: 200px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./proDuctCunzheng.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./proDuctCunzheng.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./proDuctCunzheng.vue?vue&type=template&id=fe220a4a&scoped=true&\"\nimport script from \"./proDuctCunzheng.vue?vue&type=script&lang=js&\"\nexport * from \"./proDuctCunzheng.vue?vue&type=script&lang=js&\"\nimport style0 from \"./proDuctCunzheng.vue?vue&type=style&index=0&id=fe220a4a&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fe220a4a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}