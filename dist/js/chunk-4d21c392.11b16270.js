(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d21c392"],{"39da":function(t,e,s){},"55e3":function(t,e,s){"use strict";s("39da")},"8b74":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{width:"100%",height:"100%",position:"relative",display:"flex","justify-content":"center","align-items":"center"}},[s("el-form",{ref:"form",staticClass:"printForm",attrs:{"label-width":"150px",model:t.form}},[s("p",{staticClass:"tit"},[t._v("溯源码打印管理")]),s("el-form-item",{attrs:{label:"样式选择"}},[s("el-select",{staticClass:"select-width",attrs:{placeholder:"选择打印方式"},model:{value:t.printStyle,callback:function(e){t.printStyle=e},expression:"printStyle"}},[s("el-option",{attrs:{label:"普通标签二维码",value:"normal"}})],1)],1),s("el-form-item",{attrs:{label:"产品名称"}},[s("el-select",{staticClass:"select-width",attrs:{placeholder:"请选择产品名称"},on:{change:t.getPch},model:{value:t.printCpmc,callback:function(e){t.printCpmc=e},expression:"printCpmc"}},t._l(t.cpmcList,(function(t){return s("el-option",{key:t.index,attrs:{label:t,value:t}})})),1)],1),s("el-form-item",{attrs:{label:"批次号"}},[s("el-select",{staticClass:"select-width",attrs:{placeholder:"请选择产品批次号"},model:{value:t.printPch,callback:function(e){t.printPch=e},expression:"printPch"}},t._l(t.pchList,(function(t){return s("el-option",{key:t.index,attrs:{value:t,label:t}})})),1)],1),s("el-form-item",{attrs:{label:"打印份数"}},[s("el-input-number",{staticClass:"large",attrs:{min:1,max:10},model:{value:t.printNum,callback:function(e){t.printNum=e},expression:"printNum"}})],1),s("el-form-item",[s("el-button",{staticClass:"large",attrs:{type:"primary"},on:{click:t.createCode}},[t._v("立即创建二维码")])],1)],1),s("el-dialog",{attrs:{title:"二维码打印界面",visible:t.printDialogVisible,width:"30%","destroy-on-close":!0,center:""},on:{"update:visible":function(e){t.printDialogVisible=e}}},[s("div",{staticClass:"symContainer",attrs:{id:"printArea"}},[s("div",{staticClass:"sym-tit"},[t._v(" 物联网+区块链食品安全追溯系统 ")]),s("ul",{staticClass:"symInfo"},[s("li",[t._v("产品名称："+t._s(t.symMsg.cpmc))]),s("li",[t._v("生产日期："+t._s(t.symMsg.data))]),s("li",[t._v("企业电话："+t._s(t.symMsg.fzrtel))]),s("li",[t._v("溯源码："+t._s(t.symMsg.sym))])]),s("div",{ref:"qrcode",staticClass:"sym",attrs:{id:"qrcode"}})]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{directives:[{name:"print",rawName:"v-print",value:"#printArea",expression:"'#printArea'"}],attrs:{type:"primary"}},[t._v("打 印")])],1)])],1)},a=[],i=s("1da1"),r=(s("96cf"),s("d044")),c=s.n(r),o={data:function(){return{tableData:[],printStyle:"",printCpmc:"",printPch:"",cpInfoList:[],cpmcList:[],pchList:[],postMsg:{token:"",pch:"",cpmc:""},queryInfo:{query:"",page:1},symMsg:{cpmc:"",data:"",fzrtel:"",sym:""},tokenStr:"",isAddInfo:!0,form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},printNum:1,printDialogVisible:!1,print2DialogVisible:!1,downloadButton:!1,configs:{value:"",imagePath:"/static/1560242161(1).png",filter:"color"},total:0,baseUrl:"http://ahtea.wtycms.cn"}},created:function(){this.tokenStr=window.sessionStorage.getItem("token"),this.postMsg.token=window.sessionStorage.getItem("token"),this.getPrintData(),this.getTableData()},methods:{getTableData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post("TraceabilityList",t.queryInfo);case 2:s=e.sent,n=s.data,console.log(n),t.tableData=n.data.result,t.total=n.data.total;case 7:case"end":return e.stop()}}),e)})))()},getPrintData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.queryInfo.token=t.tokenStr,e.next=3,t.$http.post("ProductionInfo",t.queryInfo);case 3:for(s=e.sent,n=s.data,console.log(n),t.cpInfoList=n.data.result,a=0;a<t.cpInfoList.length;a++)-1==t.cpmcList.indexOf(t.cpInfoList[a].cpmc)&&t.cpmcList.push(t.cpInfoList[a].cpmc);case 8:case"end":return e.stop()}}),e)})))()},getPch:function(){this.pchList=[];for(var t=0;t<this.cpInfoList.length;t++)this.printCpmc==this.cpInfoList[t].cpmc&&this.pchList.push(this.cpInfoList[t].pch)},handleCurrentChange:function(t){this.queryInfo.page=t,this.getTableData()},createCode:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.printCpmc&&""!=e.printPch){t.next=3;break}return e.$message.error("请完善打印信息"),t.abrupt("return");case 3:return e.postMsg.pch=e.printPch,e.postMsg.cpmc=e.printCpmc,t.next=7,e.$http.post("TraceabilityPrint",e.postMsg);case 7:s=t.sent,n=s.data,console.log(n),e.symMsg.cpmc=n.data.cpmc,e.symMsg.data=n.data.date,e.symMsg.fzrtel=n.data.fzrtel,e.symMsg.sym=n.data.sym,e.codeUrl=e.baseUrl+"/#/sym/"+e.symMsg.sym,e.printDialogVisible=!0,e.$nextTick((function(){this.qrcode()}));case 17:case"end":return t.stop()}}),t)})))()},qrcode:function(){new c.a("qrcode",{width:135,height:135,text:this.codeUrl})}},watch:{isAddInfo:function(){console.log(this.isAddInfo)}}},l=o,p=(s("55e3"),s("2877")),u=Object(p["a"])(l,n,a,!1,null,"2b8c5d74",null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-4d21c392.11b16270.js.map